# naive method

Perhaps the simplest approach to performing in-database connected components analysis is to begin by choosing for each vertex a representative by picking the vertex with the minimum ID among the vertex itself and all its neighbours, then to improve on that representative by taking the minimum ID among the *representatives* of the vertex itself and all its neighbours, and to continue in this fashion until no vertex changes its choice of representative. We refer to this naive approach as the â€œBreadth First Searchâ€ strategy: after n steps each vertexâ€™s representative is the vertex with the minimum ID among all vertices in the connected component that are at most at distance n from the original vertex. Though the algorithm ultimately terminates and delivers the correct result, its worst-case runtime makes it unsuitable for Big Data. Consider, for example, the sequentially numbered path graph with IDs 1, 2, . . . , n. For this graph, Breadth First Search will take n âˆ’ 1 steps.

# paper method

å¥½çš„ï¼æˆ‘ä»¬æ¥æ„é€ ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä¾‹å­ï¼Œå›¾ä¸­åŒ…å«å¤šä¸ªè¿é€šåˆ†é‡å’Œå¤šä¸ªå±‚çº§çš„â€œä¼ æ’­â€ï¼Œä»è€Œæ›´æ¸…æ¥šåœ°å±•ç¤º **Randomised Contractionï¼ˆéšæœºæ”¶ç¼©ï¼‰** æ˜¯å¦‚ä½•é€è½®ç¼©å°å›¾å¹¶æ‰¾åˆ°è¿é€šåˆ†é‡çš„ã€‚

------

## ğŸ§  ç¤ºä¾‹å›¾ Gâ‚€ï¼ˆåˆå§‹å›¾ï¼‰

```
lua


å¤åˆ¶ç¼–è¾‘
è¿é€šåˆ†é‡1ï¼š      è¿é€šåˆ†é‡2ï¼š

1---2---3        6---7
 \     |         |
  \    |         8
   \   |
     4---5

å•ç‹¬èŠ‚ç‚¹ï¼š 9
```

### ğŸ”¢ é¡¶ç‚¹ Vâ‚€ï¼š

```
å¤åˆ¶ç¼–è¾‘
{1,2,3,4,5,6,7,8,9}
```

### ğŸ”— è¾¹ Eâ‚€ï¼š

```
scss


å¤åˆ¶ç¼–è¾‘
(1,2), (1,4), (2,3), (3,4), (4,5)
(6,7), (6,8)
```

å…± 9 ä¸ªç‚¹ï¼Œåˆ†ä¸º 3 ä¸ªè¿é€šåˆ†é‡ï¼š

- {1,2,3,4,5}
- {6,7,8}
- {9}ï¼ˆå­¤ç«‹èŠ‚ç‚¹ï¼‰

------

## ğŸ” ç¬¬ 1 æ­¥ï¼šä¸ºæ¯ä¸ªç‚¹é€‰æ‹©ä»£è¡¨ï¼ˆé—­é‚»åŸŸä¸­æœ€å° IDï¼‰

| é¡¶ç‚¹ | é‚»å±…  | é—­é‚»åŸŸ  | ä»£è¡¨ï¼ˆæœ€å° IDï¼‰ |
| ---- | ----- | ------- | --------------- |
| 1    | 2,4   | 1,2,4   | 1               |
| 2    | 1,3   | 1,2,3   | 1               |
| 3    | 2,4   | 2,3,4   | 2               |
| 4    | 1,3,5 | 1,3,4,5 | 1               |
| 5    | 4     | 4,5     | 4               |
| 6    | 7,8   | 6,7,8   | 6               |
| 7    | 6     | 6,7     | 6               |
| 8    | 6     | 6,8     | 6               |
| 9    | â€”     | 9       | 9               |



------

## ğŸ” æ„é€ æ”¶ç¼©å›¾ Gâ‚

æˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„ä»£è¡¨æ„é€ æ–°å›¾ï¼š

### é¡¶ç‚¹é›†åˆ Vâ‚ï¼š

```
å¤åˆ¶ç¼–è¾‘
{1,2,4,6,9}
```

### è¾¹é›†åˆ Eâ‚ï¼š

éå†åŸå›¾æ¯æ¡è¾¹ `(v, w)`ï¼Œå¦‚æœ `r(v) â‰  r(w)`ï¼Œå°±ä¿ç•™ä¸€æ¡ `(r(v), r(w))`ï¼š

- (1,2) â†’ (1,1) â†’ å¿½ç•¥
- (1,4) â†’ (1,1) â†’ å¿½ç•¥
- (2,3) â†’ (1,2) â†’ âœ… ä¿ç•™ (1,2)
- (3,4) â†’ (2,1) â†’ âœ… ä¿ç•™ (2,1)
- (4,5) â†’ (1,4) â†’ âœ… ä¿ç•™ (1,4)
- (6,7), (6,8), (7,6) â†’ éƒ½æ˜¯ (6,6) â†’ å¿½ç•¥
- 9 æ˜¯å­¤ç«‹ â†’ ä¿ç•™

æœ€ç»ˆï¼š

```
mathematica


å¤åˆ¶ç¼–è¾‘
Eâ‚ = {(1,2), (1,4), (2,1)} ï¼ˆç­‰ä»·äº 1â€“2, 1â€“4ï¼‰
```

å›¾ Gâ‚ï¼š

```
lua


å¤åˆ¶ç¼–è¾‘
1---2
|
4

6   9 ï¼ˆå­¤ç«‹ï¼‰
```

------

## ğŸ” ç¬¬ 2 æ­¥ï¼šå†æ¬¡æ”¶ç¼©

å†æ¬¡é€‰ä»£è¡¨ï¼š

| é¡¶ç‚¹ | é‚»å±… | é—­é‚»åŸŸ | ä»£è¡¨ |
| ---- | ---- | ------ | ---- |
| 1    | 2,4  | 1,2,4  | 1    |
| 2    | 1    | 1,2    | 1    |
| 4    | 1    | 1,4    | 1    |
| 6    | â€”    | 6      | 6    |
| 9    | â€”    | 9      | 9    |



------

## ğŸ” æ„é€ æ”¶ç¼©å›¾ Gâ‚‚

- æ‰€æœ‰ {1,2,4} éƒ½æŒ‡å‘ 1 â†’ åˆå¹¶
- æ²¡æœ‰æ–°è¾¹äº†ï¼Œåªå‰©å­¤ç«‹ç‚¹

æœ€ç»ˆ Gâ‚‚ çš„é¡¶ç‚¹æ˜¯ï¼š

```
å¤åˆ¶ç¼–è¾‘
{1,6,9}ï¼ˆå‡ä¸ºå­¤ç«‹ç‚¹ï¼‰
```

------

## âœ… æœ€ç»ˆç»“æœï¼šæ¯ä¸ªé¡¶ç‚¹å½’å±çš„è¿é€šåˆ†é‡ ID

ä» râ‚ å’Œ râ‚‚ åˆå¹¶çš„æ˜ å°„ï¼š

| é¡¶ç‚¹ | râ‚   | râ‚‚(râ‚) | æœ€ç»ˆåˆ†é‡ ID |
| ---- | ---- | ------ | ----------- |
| 1    | 1    | 1      | 1           |
| 2    | 1    | 1      | 1           |
| 3    | 2    | 1      | 1           |
| 4    | 1    | 1      | 1           |
| 5    | 4    | 1      | 1           |
| 6    | 6    | 6      | 6           |
| 7    | 6    | 6      | 6           |
| 8    | 6    | 6      | 6           |
| 9    | 9    | 9      | 9           |



------

## ğŸ¯ è¾“å‡ºï¼š

æ¯ä¸ªé¡¶ç‚¹å¯¹åº”çš„è¿é€šåˆ†é‡ IDï¼š

```
diff


å¤åˆ¶ç¼–è¾‘
+-------+---------------------+
| é¡¶ç‚¹  | è¿é€šåˆ†é‡ ID (label) |
+-------+---------------------+
| 1     | 1                   |
| 2     | 1                   |
| 3     | 1                   |
| 4     | 1                   |
| 5     | 1                   |
| 6     | 6                   |
| 7     | 6                   |
| 8     | 6                   |
| 9     | 9                   |
+-------+---------------------+
```

------

å¦‚æœä½ æƒ³ï¼Œæˆ‘å¯ä»¥ç”¨ SQL æˆ–å›¾å›¾åƒå°†è¿™ä¸ªè¿‡ç¨‹å¯è§†åŒ–ï¼Œæˆ–è€…ç»™å‡ºè¿™ä¸ªç®—æ³•çš„é€’å½’è¡¨è¾¾å¼å®ç°ã€‚æ˜¯å¦éœ€è¦ï¼Ÿ